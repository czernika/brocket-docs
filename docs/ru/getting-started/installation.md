# Установка :id=installation

Если Ваше окружение соответствует всем [минимальным требованиям](ru/getting-started/requirements.md), можно приступить к установке проекта

## Установка через Composer :id=composer

Чтобы установить последний релиз Brocket Framework в папку `<project-folder>`, выполните следующую команду:

```
composer create-project czernika/brocket <project-folder>
```

Это позволит создать базовую структуру проекта, установить ядро WordPress и все необходимые PHP зависимости и плагины. Затем внутри файла  `.env` в корне проекта заполните корректную [информацию](ru/getting-started/env.md?id=env) для запуска приложения, такую как данные для подключения к базе данных и веб-адрес сайта

> Если Вы не видите файл `.env`, скопируйте файл `.env.example` и переименуйте его

Далее необходимо будет создать базу данных, если Вы не сделали это ранее. После этого проследуйте по адресу `WP_HOME` в браузере и завершите установку ядра

### Завершение установки при помощи wp-cli :id=create-wp-cli

Перейдите в корень проекта и выполните команду для создания базы. Утилита сама возьмет данные из файла `.env` 

```sh
cd <project-folder>

wp db create
```

!> Любые команды утилиты wp-cli следует запускать в корне проекта

Команда создаст базу данных с именем `DB_NAME` и префиксом `DB_PREFIX` для всех таблиц

Завершите установку при помощи команды

```sh
wp core install --url={url} --title={site-title} --admin_user={username} [--admin_password={password}] --admin_email={email} [--skip-email]
```

!> Параметр `--url` должен совпадать со значением `WP_HOME`

?> Вы можете сгенерировать "соли" WordPress - просто перейдите по ссылке [https://roots.io/salts.html](https://roots.io/salts.html) и вставьте сгенерированные ключи в файл `.env` или используйте команду `wp dotenv salts generate`, которая доступна после установки [wp-cli-dotenv-command](https://github.com/aaemnnosttv/wp-cli-dotenv-command) пакета для WP CLI

Чтобы иметь полный доступ ко всем возможностям плагина [Query Monitor](https://querymonitor.com/) (который устанавливается по умолчанию вместе с ядром WordPress), запустите [следующую команду](https://github.com/johnbillion/query-monitor/wiki/db.php-Symlink#using-wp-cli)

```sh
wp qm enable
```

Query Monitor используется для дебагинга Вашего сайта и выявления существующих и потенциальных проблем

После этого Вы можете авторизоваться на сайте, пройдя по адресу `/wp/wp-login.php` и на этом все!

## Запуск вместе с Docker :id=docker

Brocket стремится сделать Вашу жизнь легче, а потому сразу поставляется вместе с файлом `docker-compose.yml` - Вам нужен лишь установленный [Docker](https://www.docker.com/) на Вашем компьютере. После установки проекта, запустите контейнер командой

```sh
docker-compose up -d --build
```

!> Для запуска в Docker переменная `DB_HOST` должна иметь значение имени образа, то есть, `mysql`. Также для корректной работы сервера необходимо определить переменную `DOMAIN`

Далее измените разрешения и владельца папки `web/app/uploads`. Это нужно для того, чтобы пользователь сайта (администратор) имел возможность загружать файлы через медиа-загрузчик

```sh
docker exec -it brocket-php bash

chown -R www-data:www-data /var/www/html/web/app/uploads

chmod -R 755 /var/www/html/web/app/uploads
```

Чтобы запустить сайт по https-протоколу, установите [mkcert](https://github.com/FiloSottile/mkcert) на Вашей машине, проследуйте ее первичным настройкам, а затем внутри папки `docker/nginx/certs` создайте ключи сертификата

```sh
mkcert domain.name
```

Команда создаст пару ключей для домена domain.name - закрытый и открытый - которые Вы и должны подключить в файле конфигурации `docker/nginx/default.conf`.

!> Если в процессе разработки Вы видите ошибку `SSL_ERROR_RX_RECORD_TOO_LONG`, откройте сайт не по адресу `localhost:3000`, а по `127.0.0.1:3000` или в режиме инкогнито

Конечно, Вы можете изменить любую конфигурацию - nginx, php или Docker в целом перед запуском или же вовсе не использовать Docker - тогда можете смело удалить папку `docker` и файлы `docker-compose.yml`, `Dockerfile`.

## Настройка wp-cli :id=wp-cli

Для лучшего опыта разработки сайта на WordPress Вы можете установить утилиту [wp-cli](https://wp-cli.org).

В корне проекта уже присутствует файл `wp-cli.yml`, который настроен для работы на сайте со структурой Bedrock. По-умолчанию, он запрещает удалять базу, ставить плагины и создавать новых пользователей через консоль. Чтобы "нормально" и без ограничений работать в локальной среде разработки, скопируйте этот файл, переименуйте его в `wp-cli.local.yml` и уберите все ненужные команды

Этот файл будет иметь приоритет по сравнению с `wp-cli.yml`

Пример минимально необходимой конфигурации для корректной работы утилиты со структурой Bedrock:

```yml
# wp-cli.local.yml

path: web/wp
server:
  docroot: web
```

> `wp-cli.local.yml` уже прописан внутри файла `.gitignore`, потому не следует опасаться его случайного попадания на рабочее окружение при деплое

## Запуск рабочего окружения :id=development

Чтобы начать разработку фронта сайта, установите все необходимые зависимости командой

```sh
npm install
```

А затем запустите компиляцию файлов и слежение за ними через

```sh
npm run watch
```

Сайт откроется по адресу `http://localhost:3000`

![Главный экран](../../_media/screen.png)

Подробнее о работе с фронтом сайта и сборкой проекта в разделе Работа с фронтом сайта