# Установка :id=installation

Если Ваше рабочее окружение соответствует всем [минимальным требованиям](ru/getting-started/requirements.md), переходим к следующему этапу

## Базовая установка :id=basic

Чтобы создать новое приложение на основе Brocket Framework в папке `project-folder`, откройте ваш терминал и выполните команду:

```sh
composer create-project czernika/brocket project-folder
```

или же последовательностью команд - создать папку, перейти в нее и установить проект внутри

```sh
mkdir project-folder

cd project-folder

composer create-project czernika/brocket .
```

> Это позволит создать базовую структуру проекта, установить ядро WordPress и все необходимые PHP зависимости и плагины

Затем внутри файла  `.env` в корне проекта заполните необходимые данные для подключения к базе и веб-адрес сайта. Список всех переменных и их значение внутри файла конфигурации приведен в таблице ниже. **Жирным** выделены обязательные к заполнению параметры

> Если Вы не видите файл `.env` в корне проекта, скопируйте файл `.env.example` и переименуйте его

| Переменная | Определение |
| ------ | ------ |
| **DB_NAME** | Имя базы данных |
| **DB_USER** | Пользователь базы данных |
| **DB_PASSWORD** | Пароль пользователя базы данных |
| DB_HOST | Хост базы данных |
| DB_PREFIX | Префикс таблиц базы данных |
| WP_ENV | Окружение сайта |
| **WP_HOME** | УРЛ вашего сайта (адрес, включая протокол http или https) |
| **WP_SITEURL** | УРЛ, где расположено ядро WordPress |
| WP_DEBUG_LOG | Путь к файлам логов внутри темы |
| MAIL_MAILER | Дефолтный отправщик сообщений |
| MAIL_HOST - MAIL_ENCRYPTION | Настройки произвольного SMTP хоста для отправки сообщений |
| MAIL_FROM_ADDRESS, MAIL_FROM_NAME | Адрес и имя отправителя сообщения |
| AUTH_KEY - NONCE_SALT | "Соли" WordPress |

Более подробное описание всех переменных [здесь](/ru/getting-started/env.md?id=env)

Далее необходимо будет создать базу данных, если Вы не сделали это ранее. После этого проследуйте по адресу `WP_HOME` в браузере и завершите установку сайта

!> Если Вы видите ошибку о том, что WordPress не может создать тестовый файл внутри папки `web/app` (это можно легко определить по тому, что невозможно будет установить ни один языковой пакет, кроме английского), то внутри файла `config/application.php` определите константу `FS_METHOD` как `direct` **ДО** вызова метода `Config::apply()` 

```php
Config::define( 'FS_METHOD', 'direct' );
```

?> Следите за правами на файлы и папки - для папок рекомендуемое значение **755**, для файлов - **644**

!> Помните, что корень сервера должен указывать в папку `web`. Для nginx нужно будет изменить root на что-то вроде `root /srv/www/example.com/web;`. Для apache можно будет создать файл `.htaccess` в корне проекта со следующим содержимым:

```
RewriteEngine on

RewriteCond %{REQUEST_URI} !web/
RewriteRule (.*) /web/$1 [L]
```

### Завершение установки при помощи wp-cli :id=create-wp-cli

Для лучшего опыта разработки сайта на WordPress Вы можете установить утилиту [wp-cli](https://wp-cli.org).

> В корне проекта уже присутствует файл `wp-cli.yml`, который настроен для работы на сайте со структурой Bedrock. По умолчанию, он запрещает удалять базу, ставить плагины и создавать новых пользователей через консоль. Чтобы "нормально" и без ограничений работать в локальной среде разработки, скопируйте этот файл, переименуйте его в `wp-cli.local.yml` и уберите все ненужные команды. Этот файл будет иметь приоритет по сравнению с `wp-cli.yml`

Пример минимально необходимой конфигурации для корректной работы утилиты для сайтов со структурой Bedrock:

```yml
# wp-cli.local.yml

path: web/wp
server:
  docroot: web
```

> `wp-cli.local.yml` уже прописан внутри файла `.gitignore`, потому не следует опасаться его случайного попадания на рабочее окружение при деплое

Чтобы завершить установку проекта, перейдите в его корень и выполните команду для создания базы

```sh
wp db create
```

!> Любые команды утилиты wp-cli следует запускать в корне проекта

Команда создаст базу данных с именем `DB_NAME` и префиксом `DB_PREFIX` для всех таблиц

Завершите установку при помощи команды

```sh
wp core install --url={url} --title={site-title} --admin_user={username} [--admin_password={password}] --admin_email={email} [--skip-email]
```

!> Параметр `--url` должен совпадать со значением `WP_HOME`

?> Вы можете сгенерировать "соли" WordPress - запустите команду `php brocooly salts:generate` или перейдите по ссылке [https://roots.io/salts.html](https://roots.io/salts.html) и вставьте сгенерированные ключи в файл `.env`. Вы также можете использовать команду `wp dotenv salts generate`, которая доступна после установки [wp-cli-dotenv-command](https://github.com/aaemnnosttv/wp-cli-dotenv-command) пакета для WP CLI

По умолчанию, Brocket устанавливается с плагином [Query Monitor](https://querymonitor.com/) для разработки. Он используется для дебагинга Вашего сайта и выявления существующих и потенциальных проблем

> Вам также может быть интересна [статья](https://kamilgrzegorczyk.com/2018/05/02/how-to-disable-plugins-on-certain-environment/) о том, как отключить определенные плагины на определенном окружении

Чтобы иметь полный доступ ко всем возможностям плагина, Вы можете запустить [следующую команду](https://github.com/johnbillion/query-monitor/wiki/db.php-Symlink#using-wp-cli), которая создаст символическую ссылку для файла `web/app/dp.php`

```sh
wp qm enable
```

После этого Вы можете авторизоваться на сайте, пройдя по адресу `/wp/wp-login.php` и на этом все!

## Запуск вместе с Docker :id=docker

Подробнее о запуске сайта с Docker описано [здесь](/ru/advanced/docker.md)

## Запуск рабочего окружения :id=development

Brocket поставляется с предустановленными настройками для быстрой работы с TailwindCSS и Laravel-mix. Вы можете удалить соответствующие файлы конфигурации, если предпочитаете иные методы сборки фронта сайта

Чтобы установить зависимости проекта и начать сборку файлов, а также слежение за ними, выполните следующие команды

```sh
npm install

npm run watch
```

Сайт откроется в новой вкладке по адресу `http://localhost:3000`

![Главный экран](../../_media/screen.png)

Подробнее о работе с фронтом сайта и сборкой проекта в разделе Работа с фронтом сайта